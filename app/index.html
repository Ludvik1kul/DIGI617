<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Sentiment Demo</title>
</head>
<body>
  <h2>Sentiment Generator</h2>
  <textarea id="text" rows="4" cols="50" placeholder="Type something..."></textarea><br><br>
  <button onclick="analyze()">Analyze</button>
  <pre id="result"></pre>

  <script>
    async function analyze() {
  const text = document.getElementById("text").value;
  if (!text) return;

  document.getElementById("result").innerText = "Analyzing...";

  try {
    const res = await fetch("/api/hf", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ inputs: text })
    });

    const data = await res.json();

    if (!res.ok) {
      throw new Error(data.error || JSON.stringify(data));
    }

    // Check if data is an array with label/score
    if (Array.isArray(data) && data.length && data[0].label && data[0].score !== undefined) {
      // Get the label with the highest score
      const best = data.reduce((a, b) => (a.score > b.score ? a : b));
      document.getElementById("result").innerText = `Sentiment: ${best.label} (score: ${best.score})`;
    } else {
      // Fallback: show raw JSON
      document.getElementById("result").innerText = JSON.stringify(data, null, 2);
    }

  } catch (err) {
    document.getElementById("result").innerText = "Error: " + err.message;
  }
}

  </script>
</body>
</html>
